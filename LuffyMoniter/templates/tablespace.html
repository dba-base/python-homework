<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>表空间</title>
</head>
<body>
</body>
<script src="/static/echarts.min.js" charset="utf-8" type="text/javascript"></script>
<script src="/static/jquery-2.1.1.min.js" charset="utf-8" type="text/javascript"></script>
<script src="/static/js/bootstrap.min.js"></script>
{#{% include 'host_list_js_component.html' %}#}
<script type="text/javascript">
    function adddiv() {
        var hosts = [{% for h in hosts %}'{{ h.host_id }}',{% endfor %}];
        console.log(hosts)
        hosts.forEach(function (host) {
            $("body").prepend('<div id="host'+host+'"'+' style="width:400px;height:200px;left:1%;float: left"></div>')
            name = $("div").attr('id')
            console.log(name,host)
            echart(name,host)
        })
    }

    // 使用
    function echart(name,host) {
        var myChart = echarts.init(document.getElementById(name));
        // 基于准备好的dom，初始化echarts图表
        var tbs_name = [{% for tbs in tablespace_img %}'{{ tbs.name }}',{% endfor %}];
        var tbs_used = [{% for tbs in tablespace_img %}'{{ tbs.used_size | floatformat:1 }}',{% endfor %}];
        var tbs_free = [{% for tbs in tablespace_img %}'{{ tbs.free_size | floatformat:1 }}',{% endfor %}];
        var ip_addr = "{{ tablespace_img.0.host }}";
        console.log(tbs_name)
        var option = {
            title: {
                text: '表空间',
                subtext: "IP地址：" + ip_addr
            },
            label: {
                textStyle: {
                    color: 'rgba(255, 255, 255, 0.3)'
                }
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {            // 坐标轴指示器，坐标轴触发有效
                    type: 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                }
            },
            legend: {
                data: ['已用（MB）', '剩余(MB)']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: [
                {
                    type: 'category',
                    data: tbs_name
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    axisLabel: {
                        formatter: '{value} MB'
                    }
                }
            ],
            series: [
                {
                    name: '已用（MB）',
                    type: 'bar',
                    stack: '表空间',
                    data: tbs_used
                },
                {
                    name: '剩余(MB)',
                    type: 'bar',
                    stack: '表空间',
                    data: tbs_free
                },


            ]
        };
        // 为echarts对象加载数据
        myChart.setOption(option);
    }
    adddiv()


</script>
</html>